(()=>{var e={};e.id=137,e.ids=[137],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6231:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>d});var a=t(482),r=t(9108),i=t(2563),l=t.n(i),n=t(8300),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["(dashboard)",{children:["security",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,5182)),"/Users/rizkyakbar/Projects/mine/LoadTest/load-test-client/app/(dashboard)/security/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8519)),"/Users/rizkyakbar/Projects/mine/LoadTest/load-test-client/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9361,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,2917)),"/Users/rizkyakbar/Projects/mine/LoadTest/load-test-client/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9361,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/rizkyakbar/Projects/mine/LoadTest/load-test-client/app/(dashboard)/security/page.tsx"],x="/(dashboard)/security/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(dashboard)/security/page",pathname:"/security",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9411:(e,s,t)=>{Promise.resolve().then(t.bind(t,1416))},1416:(e,s,t)=>{"use strict";t.r(s),t.d(s,{SecurityCheckPanel:()=>h});var a=t(5344),r=t(3729),i=t(8428),l=t(3673),n=t(6540),c=t(7361),d=t(5094),o=t(9591);async function x(e,s){let t=await fetch("/api/security-check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationId:e,url:s})});if(!t.ok)throw Error((await t.json().catch(()=>({}))).error??"Security check failed.");return await t.json()}var u=t(6813);function h({organizations:e}){let s=(0,i.useRouter)(),[t,h]=(0,r.useState)(e),[m,p]=(0,r.useState)(e[0]?.id??null);(0,r.useEffect)(()=>{h(e),e.some(e=>e.id===m)||p(e[0]?.id??null)},[e,m]);let j=(0,r.useMemo)(()=>t.find(e=>e.id===m)??null,[t,m]),g=(0,r.useMemo)(()=>!!j&&j.credits>=u.kb,[j]),[b,N]=(0,r.useState)("https://example.com"),[v,w]=(0,r.useState)(null),[f,y]=(0,r.useState)(null),[k,S]=(0,r.useState)(!1),P=async e=>{if(e.preventDefault(),!m){y("Select an organization to charge credits against.");return}if(!g){y(`Insufficient credits. Security checks cost ${u.kb} credits.`);return}y(null),S(!0);try{let e=await x(m,b.trim());w(e),h(e=>e.map(e=>e.id===m?{...e,credits:e.credits-u.kb}:e)),s.refresh()}catch(e){w(null),y(e.message)}finally{S(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(l.Zb,{className:"shadow-card",children:[(0,a.jsxs)(l.Ol,{children:[a.jsx(l.ll,{children:"Inspect Endpoint"}),(0,a.jsxs)(l.SZ,{children:["Validate security headers, extract page metadata, and surface ownership hints for any HTTP(S) target. Cost: ",u.kb," credits."]})]}),a.jsx(l.aY,{children:(0,a.jsxs)("form",{className:"space-y-4",onSubmit:P,children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"security-organization",className:"text-xs uppercase tracking-wide text-slate-400",children:"Organization"}),a.jsx("select",{id:"security-organization",value:m??"",onChange:e=>p(e.target.value||null),className:"w-full rounded-lg border border-slate-800/70 bg-slate-950/70 px-3 py-2 text-sm text-slate-100",children:t.map(e=>a.jsx("option",{value:e.id,children:`${e.name} (${e.credits} credits)`},e.id))}),j?(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["Credits remaining: ",j.credits]}):a.jsx("p",{className:"text-xs text-warning",children:"No organizations available. Create one or request access before running checks."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"security-url",className:"text-xs uppercase tracking-wide text-slate-400",children:"Target URL"}),a.jsx(n.I,{id:"security-url",name:"url",type:"url",autoComplete:"off",placeholder:"https://your-service.com",value:b,onChange:e=>N(e.target.value),required:!0})]}),f?a.jsx("div",{className:"rounded-lg border border-danger/40 bg-danger/10 px-3 py-2 text-sm text-danger",children:f}):null,a.jsx(d.z,{type:"submit",disabled:k||!m||!g,className:"w-full sm:w-auto",children:k?"Running checks…":"Run security check"}),g?null:(0,a.jsxs)("p",{className:"text-xs text-warning",children:["Insufficient credits. Security checks cost ",u.kb," credits."]})]})})]}),v?(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1.15fr_0.85fr]",children:[(0,a.jsxs)(l.Zb,{className:"shadow-card",children:[(0,a.jsxs)(l.Ol,{children:[a.jsx(l.ll,{children:"Summary"}),(0,a.jsxs)(l.SZ,{children:[v.finalUrl," • HTTP ",v.statusCode," • ",new Date(v.fetchedAt).toLocaleString()]})]}),(0,a.jsxs)(l.aY,{className:"space-y-4 text-sm text-slate-300",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-xs text-slate-400",children:[a.jsx(o.C,{variant:v.usesHttps?"success":"warning",children:v.usesHttps?"HTTPS enforced":"HTTP fallback"}),(0,a.jsxs)(o.C,{variant:"default",children:["Requested: ",v.requestedUrl]}),(0,a.jsxs)(o.C,{variant:"default",children:["Resolved: ",v.finalUrl]})]}),v.warnings.length>0?(0,a.jsxs)("div",{className:"rounded-lg border border-warning/40 bg-warning/10 px-4 py-3 text-sm text-warning",children:[a.jsx("p",{className:"font-semibold",children:"Warnings"}),a.jsx("ul",{className:"mt-2 list-disc space-y-1 pl-5",children:v.warnings.map(e=>a.jsx("li",{children:e},e))})]}):a.jsx("p",{className:"text-xs text-slate-500",children:"No warnings. Endpoint meets baseline controls."}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800/70 bg-slate-900/60 p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-100",children:"Metadata"}),(0,a.jsxs)("dl",{className:"mt-2 space-y-1 text-xs text-slate-400",children:[(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Title"}),a.jsx("dd",{className:"text-slate-300",children:v.metadata.title??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Description"}),a.jsx("dd",{className:"text-slate-300",children:v.metadata.description??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"OG Title"}),a.jsx("dd",{className:"text-slate-300",children:v.metadata.openGraphTitle??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"OG Site"}),a.jsx("dd",{className:"text-slate-300",children:v.metadata.openGraphSiteName??"—"})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800/70 bg-slate-900/60 p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-100",children:"Ownership"}),v.ownership?(0,a.jsxs)("dl",{className:"mt-2 space-y-1 text-xs text-slate-400",children:[(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Domain"}),a.jsx("dd",{className:"text-slate-300",children:v.ownership.domain})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Primary NS"}),a.jsx("dd",{className:"text-slate-300",children:v.ownership.primaryNameServer??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Responsible Email"}),a.jsx("dd",{className:"text-slate-300",children:v.ownership.responsibleEmail??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Registry / WHOIS"}),a.jsx("dd",{className:"text-slate-300",children:v.ownership.registry??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Registrar"}),(0,a.jsxs)("dd",{className:"text-slate-300",children:[v.ownership.registrarName??"—",v.ownership.registrarEmail?a.jsx("span",{className:"block text-[11px] text-slate-500",children:v.ownership.registrarEmail}):null]})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Registrant"}),(0,a.jsxs)("dd",{className:"text-slate-300",children:[v.ownership.registrantName??"—",v.ownership.registrantEmail?a.jsx("span",{className:"block text-[11px] text-slate-500",children:v.ownership.registrantEmail}):null]})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"WHOIS Registrar"}),a.jsx("dd",{className:"text-slate-300",children:v.ownership.whoisRegistrar??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"WHOIS Registrant"}),a.jsx("dd",{className:"text-slate-300",children:v.ownership.whoisRegistrant??"—"})]})]}):a.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Ownership details unavailable. Review the warnings above or provide a public domain."})]})]})]})]}),(0,a.jsxs)(l.Zb,{className:"shadow-card",children:[(0,a.jsxs)(l.Ol,{children:[a.jsx(l.ll,{children:"Security Headers"}),a.jsx(l.SZ,{children:"Must-have controls and their current status."})]}),a.jsx(l.aY,{className:"space-y-3 text-xs text-slate-300",children:v.securityHeaders.map(e=>(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800/60 bg-slate-900/60 px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("p",{className:"text-sm font-semibold text-slate-100",children:e.header}),a.jsx(o.C,{variant:e.present?"success":"danger",children:e.present?"Present":"Missing"})]}),a.jsx("p",{className:"mt-1 text-slate-400",children:e.value?e.value:"No value detected."}),e.present?null:a.jsx("p",{className:"mt-2 text-[11px] text-warning",children:e.recommendation})]},e.header))})]}),(0,a.jsxs)(l.Zb,{className:"shadow-card",children:[(0,a.jsxs)(l.Ol,{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx(l.ll,{children:"TLS Overview"}),a.jsx(l.SZ,{children:"Certificate, cipher, and protocol details."})]}),v.tls?a.jsx(o.C,{variant:v.tls.isExpired?"danger":"success",children:v.tls.isExpired?"Expired":"Valid"}):null]}),(0,a.jsxs)(l.aY,{children:[v.tls?(0,a.jsxs)("dl",{className:"grid gap-4 text-xs text-slate-400 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Protocol"}),a.jsx("dd",{className:"text-slate-300",children:v.tls.protocol??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Cipher Suite"}),a.jsx("dd",{className:"text-slate-300",children:v.tls.cipherSuite??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Issuer"}),a.jsx("dd",{className:"text-slate-300",children:v.tls.issuer??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Subject"}),a.jsx("dd",{className:"text-slate-300",children:v.tls.subject??"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Valid From"}),a.jsx("dd",{className:"text-slate-300",children:v.tls.validFrom?new Date(v.tls.validFrom).toLocaleString():"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Valid To"}),a.jsx("dd",{className:"text-slate-300",children:v.tls.validTo?new Date(v.tls.validTo).toLocaleString():"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"Days Remaining"}),a.jsx("dd",{className:"text-slate-300",children:"number"==typeof v.tls.daysUntilExpiry?`${v.tls.daysUntilExpiry} days`:"—"})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"uppercase tracking-wide text-slate-500",children:"SANs"}),a.jsx("dd",{className:"text-slate-300",children:v.tls.subjectAlternativeNames.length>0?v.tls.subjectAlternativeNames.join(", "):"—"})]})]}):a.jsx("p",{className:"text-xs text-slate-500",children:"TLS inspection unavailable for this endpoint."}),v.tls?.authorizationError?(0,a.jsxs)("p",{className:"mt-3 text-[11px] text-warning",children:["TLS validation issue: ",v.tls.authorizationError]}):null]})]})]}):null]})}},9591:(e,s,t)=>{"use strict";t.d(s,{C:()=>l});var a=t(5344),r=t(1453);let i={default:"bg-surface-muted text-slate-200",success:"bg-success/20 text-success border border-success/40",warning:"bg-warning/20 text-warning border border-warning/40",danger:"bg-danger/20 text-danger border border-danger/40"};function l({className:e,variant:s="default",...t}){return a.jsx("span",{className:(0,r.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium uppercase tracking-wide",i[s],e),...t})}},3673:(e,s,t)=>{"use strict";t.d(s,{Ol:()=>l,SZ:()=>c,Zb:()=>i,aY:()=>d,ll:()=>n});var a=t(5344),r=t(1453);function i({className:e,children:s,...t}){return a.jsx("div",{className:(0,r.cn)("rounded-xl border border-slate-800/80 bg-surface-subtle/80 shadow-card backdrop-blur-sm",e),...t,children:s})}function l({className:e,children:s}){return a.jsx("div",{className:(0,r.cn)("border-b border-slate-800/40 px-6 py-4",e),children:s})}function n({className:e,children:s}){return a.jsx("h3",{className:(0,r.cn)("text-lg font-semibold text-slate-100",e),children:s})}function c({className:e,children:s}){return a.jsx("p",{className:(0,r.cn)("text-sm text-slate-400",e),children:s})}function d({className:e,children:s}){return a.jsx("div",{className:(0,r.cn)("px-6 py-5",e),children:s})}},6540:(e,s,t)=>{"use strict";t.d(s,{I:()=>l});var a=t(5344),r=t(3729),i=t(1453);let l=(0,r.forwardRef)(({className:e,type:s="text",...t},r)=>a.jsx("input",{ref:r,type:s,className:(0,i.cn)("w-full rounded-md border border-slate-800 bg-background-subtle px-3 py-2 text-sm text-slate-100 shadow-sm transition focus:border-accent-soft focus:ring-2 focus:ring-accent-soft/60",e),...t}));l.displayName="Input"},7361:(e,s,t)=>{"use strict";t.d(s,{_:()=>i});var a=t(5344),r=t(1453);function i({className:e,...s}){return a.jsx("label",{className:(0,r.cn)("block text-sm font-medium text-slate-300 tracking-wide",e),...s})}},6813:(e,s,t)=>{"use strict";t.d(s,{YK:()=>i,a:()=>r,kb:()=>l,zm:()=>a});let a=15,r=5,i=5,l=2},5182:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(5036),r=t(7439),i=t(6843);let l=(0,i.createProxy)(String.raw`/Users/rizkyakbar/Projects/mine/LoadTest/load-test-client/src/components/dashboard/security-check-panel.tsx`),{__esModule:n,$$typeof:c}=l;l.default;let d=(0,i.createProxy)(String.raw`/Users/rizkyakbar/Projects/mine/LoadTest/load-test-client/src/components/dashboard/security-check-panel.tsx#SecurityCheckPanel`);var o=t(3560);async function x(){let e=r.cookies().get("lt_token")?.value,s=await (0,o.ZC)("http://localhost:3001",e);return(0,a.jsxs)("div",{className:"space-y-6 max-h-[calc(100vh-12rem)] overflow-y-auto pr-1 sm:pr-2",children:[(0,a.jsxs)("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-2xl font-semibold text-slate-100",children:"Security Check"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Run on-demand security header audits, inspect metadata, and gather ownership hints before launching load tests against a new target."})]}),a.jsx(d,{organizations:s})]})}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[638,439,356,630,743],()=>t(6231));module.exports=a})();