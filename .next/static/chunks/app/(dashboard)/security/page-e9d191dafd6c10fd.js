(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[137],{5785:function(e,s,t){Promise.resolve().then(t.bind(t,3863))},7907:function(e,s,t){"use strict";var a=t(5313);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},3863:function(e,s,t){"use strict";t.r(s),t.d(s,{SecurityCheckPanel:function(){return h}});var a=t(3827),r=t(4090),l=t(7907),n=t(5671),i=t(2782),c=t(2647),d=t(575),o=t(3277);async function u(e,s){let t=await fetch("/api/security-check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationId:e,url:s})});if(!t.ok){var a;throw Error(null!==(a=(await t.json().catch(()=>({}))).error)&&void 0!==a?a:"Security check failed.")}return await t.json()}var x=t(2111);function h(e){var s,t,h,m,p,j,f,g,v,b,N,w,y,k,S,R,E,T;let{organizations:C}=e,O=(0,l.useRouter)(),[P,H]=(0,r.useState)(C),[z,I]=(0,r.useState)(null!==(h=null===(s=C[0])||void 0===s?void 0:s.id)&&void 0!==h?h:null);(0,r.useEffect)(()=>{if(H(C),!C.some(e=>e.id===z)){var e,s;I(null!==(s=null===(e=C[0])||void 0===e?void 0:e.id)&&void 0!==s?s:null)}},[C,z]);let Z=(0,r.useMemo)(()=>{var e;return null!==(e=P.find(e=>e.id===z))&&void 0!==e?e:null},[P,z]),_=(0,r.useMemo)(()=>!!Z&&Z.credits>=x.kb,[Z]),[A,D]=(0,r.useState)("https://example.com"),[L,U]=(0,r.useState)(null),[W,Y]=(0,r.useState)(null),[F,M]=(0,r.useState)(!1),q=async e=>{if(e.preventDefault(),!z){Y("Select an organization to charge credits against.");return}if(!_){Y("Insufficient credits. Security checks cost ".concat(x.kb," credits."));return}Y(null),M(!0);try{let e=await u(z,A.trim());U(e),H(e=>e.map(e=>e.id===z?{...e,credits:e.credits-x.kb}:e)),O.refresh()}catch(e){U(null),Y(e.message)}finally{M(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(n.Zb,{className:"shadow-card",children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{children:"Inspect Endpoint"}),(0,a.jsxs)(n.SZ,{children:["Validate security headers, extract page metadata, and surface ownership hints for any HTTP(S) target. Cost: ",x.kb," credits."]})]}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("form",{className:"space-y-4",onSubmit:q,children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"security-organization",className:"text-xs uppercase tracking-wide text-slate-400",children:"Organization"}),(0,a.jsx)("select",{id:"security-organization",value:null!=z?z:"",onChange:e=>I(e.target.value||null),className:"w-full rounded-lg border border-slate-800/70 bg-slate-950/70 px-3 py-2 text-sm text-slate-100",children:P.map(e=>(0,a.jsx)("option",{value:e.id,children:"".concat(e.name," (").concat(e.credits," credits)")},e.id))}),Z?(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["Credits remaining: ",Z.credits]}):(0,a.jsx)("p",{className:"text-xs text-warning",children:"No organizations available. Create one or request access before running checks."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"security-url",className:"text-xs uppercase tracking-wide text-slate-400",children:"Target URL"}),(0,a.jsx)(i.I,{id:"security-url",name:"url",type:"url",autoComplete:"off",placeholder:"https://your-service.com",value:A,onChange:e=>D(e.target.value),required:!0})]}),W?(0,a.jsx)("div",{className:"rounded-lg border border-danger/40 bg-danger/10 px-3 py-2 text-sm text-danger",children:W}):null,(0,a.jsx)(d.z,{type:"submit",disabled:F||!z||!_,className:"w-full sm:w-auto",children:F?"Running checks…":"Run security check"}),_?null:(0,a.jsxs)("p",{className:"text-xs text-warning",children:["Insufficient credits. Security checks cost ",x.kb," credits."]})]})})]}),L?(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1.15fr_0.85fr]",children:[(0,a.jsxs)(n.Zb,{className:"shadow-card",children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{children:"Summary"}),(0,a.jsxs)(n.SZ,{children:[L.finalUrl," • HTTP ",L.statusCode," • ",new Date(L.fetchedAt).toLocaleString()]})]}),(0,a.jsxs)(n.aY,{className:"space-y-4 text-sm text-slate-300",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-xs text-slate-400",children:[(0,a.jsx)(o.C,{variant:L.usesHttps?"success":"warning",children:L.usesHttps?"HTTPS enforced":"HTTP fallback"}),(0,a.jsxs)(o.C,{variant:"default",children:["Requested: ",L.requestedUrl]}),(0,a.jsxs)(o.C,{variant:"default",children:["Resolved: ",L.finalUrl]})]}),L.warnings.length>0?(0,a.jsxs)("div",{className:"rounded-lg border border-warning/40 bg-warning/10 px-4 py-3 text-sm text-warning",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Warnings"}),(0,a.jsx)("ul",{className:"mt-2 list-disc space-y-1 pl-5",children:L.warnings.map(e=>(0,a.jsx)("li",{children:e},e))})]}):(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"No warnings. Endpoint meets baseline controls."}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800/70 bg-slate-900/60 p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-slate-100",children:"Metadata"}),(0,a.jsxs)("dl",{className:"mt-2 space-y-1 text-xs text-slate-400",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Title"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(m=L.metadata.title)&&void 0!==m?m:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Description"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(p=L.metadata.description)&&void 0!==p?p:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"OG Title"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(j=L.metadata.openGraphTitle)&&void 0!==j?j:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"OG Site"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(f=L.metadata.openGraphSiteName)&&void 0!==f?f:"—"})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800/70 bg-slate-900/60 p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-slate-100",children:"Ownership"}),L.ownership?(0,a.jsxs)("dl",{className:"mt-2 space-y-1 text-xs text-slate-400",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Domain"}),(0,a.jsx)("dd",{className:"text-slate-300",children:L.ownership.domain})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Primary NS"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(g=L.ownership.primaryNameServer)&&void 0!==g?g:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Responsible Email"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(v=L.ownership.responsibleEmail)&&void 0!==v?v:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Registry / WHOIS"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(b=L.ownership.registry)&&void 0!==b?b:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Registrar"}),(0,a.jsxs)("dd",{className:"text-slate-300",children:[null!==(N=L.ownership.registrarName)&&void 0!==N?N:"—",L.ownership.registrarEmail?(0,a.jsx)("span",{className:"block text-[11px] text-slate-500",children:L.ownership.registrarEmail}):null]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Registrant"}),(0,a.jsxs)("dd",{className:"text-slate-300",children:[null!==(w=L.ownership.registrantName)&&void 0!==w?w:"—",L.ownership.registrantEmail?(0,a.jsx)("span",{className:"block text-[11px] text-slate-500",children:L.ownership.registrantEmail}):null]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"WHOIS Registrar"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(y=L.ownership.whoisRegistrar)&&void 0!==y?y:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"WHOIS Registrant"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(k=L.ownership.whoisRegistrant)&&void 0!==k?k:"—"})]})]}):(0,a.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"Ownership details unavailable. Review the warnings above or provide a public domain."})]})]})]})]}),(0,a.jsxs)(n.Zb,{className:"shadow-card",children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{children:"Security Headers"}),(0,a.jsx)(n.SZ,{children:"Must-have controls and their current status."})]}),(0,a.jsx)(n.aY,{className:"space-y-3 text-xs text-slate-300",children:L.securityHeaders.map(e=>(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800/60 bg-slate-900/60 px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-slate-100",children:e.header}),(0,a.jsx)(o.C,{variant:e.present?"success":"danger",children:e.present?"Present":"Missing"})]}),(0,a.jsx)("p",{className:"mt-1 text-slate-400",children:e.value?e.value:"No value detected."}),e.present?null:(0,a.jsx)("p",{className:"mt-2 text-[11px] text-warning",children:e.recommendation})]},e.header))})]}),(0,a.jsxs)(n.Zb,{className:"shadow-card",children:[(0,a.jsxs)(n.Ol,{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(n.ll,{children:"TLS Overview"}),(0,a.jsx)(n.SZ,{children:"Certificate, cipher, and protocol details."})]}),L.tls?(0,a.jsx)(o.C,{variant:L.tls.isExpired?"danger":"success",children:L.tls.isExpired?"Expired":"Valid"}):null]}),(0,a.jsxs)(n.aY,{children:[L.tls?(0,a.jsxs)("dl",{className:"grid gap-4 text-xs text-slate-400 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Protocol"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(S=L.tls.protocol)&&void 0!==S?S:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Cipher Suite"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(R=L.tls.cipherSuite)&&void 0!==R?R:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Issuer"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(E=L.tls.issuer)&&void 0!==E?E:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Subject"}),(0,a.jsx)("dd",{className:"text-slate-300",children:null!==(T=L.tls.subject)&&void 0!==T?T:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Valid From"}),(0,a.jsx)("dd",{className:"text-slate-300",children:L.tls.validFrom?new Date(L.tls.validFrom).toLocaleString():"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Valid To"}),(0,a.jsx)("dd",{className:"text-slate-300",children:L.tls.validTo?new Date(L.tls.validTo).toLocaleString():"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"Days Remaining"}),(0,a.jsx)("dd",{className:"text-slate-300",children:"number"==typeof L.tls.daysUntilExpiry?"".concat(L.tls.daysUntilExpiry," days"):"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"uppercase tracking-wide text-slate-500",children:"SANs"}),(0,a.jsx)("dd",{className:"text-slate-300",children:L.tls.subjectAlternativeNames.length>0?L.tls.subjectAlternativeNames.join(", "):"—"})]})]}):(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"TLS inspection unavailable for this endpoint."}),(null===(t=L.tls)||void 0===t?void 0:t.authorizationError)?(0,a.jsxs)("p",{className:"mt-3 text-[11px] text-warning",children:["TLS validation issue: ",L.tls.authorizationError]}):null]})]})]}):null]})}},3277:function(e,s,t){"use strict";t.d(s,{C:function(){return n}});var a=t(3827),r=t(2169);let l={default:"bg-surface-muted text-slate-200",success:"bg-success/20 text-success border border-success/40",warning:"bg-warning/20 text-warning border border-warning/40",danger:"bg-danger/20 text-danger border border-danger/40"};function n(e){let{className:s,variant:t="default",...n}=e;return(0,a.jsx)("span",{className:(0,r.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium uppercase tracking-wide",l[t],s),...n})}},575:function(e,s,t){"use strict";t.d(s,{z:function(){return i}});var a=t(3827),r=t(4090),l=t(2169);let n={primary:"bg-accent-strong text-slate-950 hover:bg-accent-soft disabled:bg-accent-soft/50 disabled:text-slate-900/60",secondary:"bg-surface-muted text-slate-100 hover:bg-surface-subtle disabled:opacity-60 border border-slate-700/60",ghost:"bg-transparent text-slate-300 hover:bg-surface-subtle/50 disabled:opacity-40"},i=(0,r.forwardRef)((e,s)=>{let{className:t,variant:r="primary",type:i="button",...c}=e;return(0,a.jsx)("button",{ref:s,type:i,className:(0,l.cn)("inline-flex items-center justify-center rounded-md text-sm font-semibold transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent-soft focus-visible:ring-offset-2 focus-visible:ring-offset-background",n[r],"px-4 py-2",t),...c})});i.displayName="Button"},5671:function(e,s,t){"use strict";t.d(s,{Ol:function(){return n},SZ:function(){return c},Zb:function(){return l},aY:function(){return d},ll:function(){return i}});var a=t(3827),r=t(2169);function l(e){let{className:s,children:t,...l}=e;return(0,a.jsx)("div",{className:(0,r.cn)("rounded-xl border border-slate-800/80 bg-surface-subtle/80 shadow-card backdrop-blur-sm",s),...l,children:t})}function n(e){let{className:s,children:t}=e;return(0,a.jsx)("div",{className:(0,r.cn)("border-b border-slate-800/40 px-6 py-4",s),children:t})}function i(e){let{className:s,children:t}=e;return(0,a.jsx)("h3",{className:(0,r.cn)("text-lg font-semibold text-slate-100",s),children:t})}function c(e){let{className:s,children:t}=e;return(0,a.jsx)("p",{className:(0,r.cn)("text-sm text-slate-400",s),children:t})}function d(e){let{className:s,children:t}=e;return(0,a.jsx)("div",{className:(0,r.cn)("px-6 py-5",s),children:t})}},2782:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var a=t(3827),r=t(4090),l=t(2169);let n=(0,r.forwardRef)((e,s)=>{let{className:t,type:r="text",...n}=e;return(0,a.jsx)("input",{ref:s,type:r,className:(0,l.cn)("w-full rounded-md border border-slate-800 bg-background-subtle px-3 py-2 text-sm text-slate-100 shadow-sm transition focus:border-accent-soft focus:ring-2 focus:ring-accent-soft/60",t),...n})});n.displayName="Input"},2647:function(e,s,t){"use strict";t.d(s,{_:function(){return l}});var a=t(3827),r=t(2169);function l(e){let{className:s,...t}=e;return(0,a.jsx)("label",{className:(0,r.cn)("block text-sm font-medium text-slate-300 tracking-wide",s),...t})}},2111:function(e,s,t){"use strict";t.d(s,{YK:function(){return l},a:function(){return r},kb:function(){return n},zm:function(){return a}});let a=15,r=5,l=5,n=2},2169:function(e,s,t){"use strict";t.d(s,{cn:function(){return r}});var a=t(3167);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.W)(s)}},3167:function(e,s,t){"use strict";function a(){for(var e,s,t=0,a="",r=arguments.length;t<r;t++)(e=arguments[t])&&(s=function e(s){var t,a,r="";if("string"==typeof s||"number"==typeof s)r+=s;else if("object"==typeof s){if(Array.isArray(s)){var l=s.length;for(t=0;t<l;t++)s[t]&&(a=e(s[t]))&&(r&&(r+=" "),r+=a)}else for(a in s)s[a]&&(r&&(r+=" "),r+=a)}return r}(e))&&(a&&(a+=" "),a+=s);return a}t.d(s,{W:function(){return a}})}},function(e){e.O(0,[971,69,744],function(){return e(e.s=5785)}),_N_E=e.O()}]);