(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[270],{812:function(e,t,s){Promise.resolve().then(s.bind(s,4081))},4081:function(e,t,s){"use strict";s.r(t),s.d(t,{AgentScans:function(){return d}});var a=s(3827),r=s(4090),n=s(7149),l=s(5671),c=s(575),i=s(2318);function d(e){var t,s,d;let{scans:o}=e,[x,u]=(0,r.useState)(null),h=(0,r.useMemo)(()=>{let e=new Map;return o.forEach(t=>{let s=e.get(t.server.id);s?s.items.push(t):e.set(t.server.id,{server:t.server,items:[t]})}),Array.from(e.values())},[o]);return 0===o.length?(0,a.jsx)(l.Zb,{className:"border-slate-800/70 bg-slate-950/60",children:(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"text-slate-100 flex items-center gap-3",children:[(0,a.jsx)(n.Z,{className:"h-5 w-5 text-accent-soft"}),"Agent Scans",(0,a.jsx)("span",{className:"rounded-full border border-accent-soft/40 bg-accent-soft/10 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-accent-soft",children:"Beta"})]}),(0,a.jsx)(l.SZ,{className:"text-slate-400",children:"No agent-driven scans yet. Once agents report back, historical jobs will appear here."})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[h.map(e=>{var t;let{server:s,items:r}=e;return(0,a.jsxs)(l.Zb,{className:"border-slate-800/70 bg-slate-950/50 shadow-2xl",children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"text-slate-100 flex items-center gap-3",children:[(0,a.jsx)(n.Z,{className:"h-5 w-5 text-accent-soft"}),s.name,(0,a.jsx)("span",{className:"rounded-full border border-accent-soft/40 bg-accent-soft/10 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-accent-soft",children:"Beta"})]}),(0,a.jsx)(l.SZ,{className:"text-slate-400",children:null!==(t=s.hostname)&&void 0!==t?t:"Hostname pending"})]}),(0,a.jsx)(l.aY,{className:"space-y-4",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-800 text-sm",children:[(0,a.jsx)("thead",{className:"bg-slate-900/60 text-slate-400",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Playbook"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Queued"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Duration"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Agent"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right",children:"Credits"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right",children:"Details"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-slate-800 text-slate-200",children:r.map(e=>{var t;let s=new Date(e.queuedAt),r=e.startedAt?new Date(e.startedAt):null,n=e.completedAt?new Date(e.completedAt):null,l=r&&n?(0,i.L)(r,n):"—";return(0,a.jsxs)("tr",{className:"hover:bg-slate-900/40",children:[(0,a.jsx)("td",{className:"px-4 py-3 font-semibold",children:e.playbook}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("span",{className:"rounded-lg bg-slate-800/60 px-2 py-1 text-xs uppercase tracking-wide",children:e.status})}),(0,a.jsx)("td",{className:"px-4 py-3 text-xs text-slate-400",children:(0,i.o)(s)}),(0,a.jsx)("td",{className:"px-4 py-3 text-xs text-slate-400",children:l}),(0,a.jsx)("td",{className:"px-4 py-3 text-xs text-slate-400",children:e.agent?"".concat(e.agent.accessKey," \xb7 ").concat(e.agent.status):"No agent"}),(0,a.jsx)("td",{className:"px-4 py-3 text-right text-xs text-slate-400",children:null!==(t=e.creditsCharged)&&void 0!==t?t:"—"}),(0,a.jsx)("td",{className:"px-4 py-3 text-right",children:(0,a.jsx)(c.z,{variant:"ghost",onClick:()=>u(e),children:"View"})})]},e.id)})})]})})})]},s.id)}),x?(0,a.jsxs)(l.Zb,{className:"border-slate-800/70 bg-slate-950/70",children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsx)(l.ll,{className:"text-slate-100",children:"Agent scan details"}),(0,a.jsxs)(l.SZ,{className:"text-slate-400",children:["Playbook ",x.playbook," \xb7 ",x.status]})]}),(0,a.jsxs)(l.aY,{className:"space-y-4 text-sm text-slate-300",children:[(0,a.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Server"}),(0,a.jsx)("p",{className:"font-medium text-slate-200",children:x.server.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Queued"}),(0,a.jsx)("p",{className:"text-slate-300",children:(0,i.o)(new Date(x.queuedAt))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Started"}),(0,a.jsx)("p",{className:"text-slate-300",children:x.startedAt?(0,i.o)(new Date(x.startedAt)):"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Completed"}),(0,a.jsx)("p",{className:"text-slate-300",children:x.completedAt?(0,i.o)(new Date(x.completedAt)):"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Credits charged"}),(0,a.jsx)("p",{className:"text-slate-300",children:null!==(t=x.creditsCharged)&&void 0!==t?t:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Failure reason"}),(0,a.jsx)("p",{className:"text-slate-300",children:null!==(s=x.failureReason)&&void 0!==s?s:"—"})]})]}),(0,a.jsx)("pre",{className:"overflow-x-auto rounded-xl bg-slate-950/80 p-4 text-xs text-slate-200",children:JSON.stringify(null!==(d=x.result)&&void 0!==d?d:{},null,2)})]})]}):null]})}},575:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var a=s(3827),r=s(4090),n=s(2169);let l={primary:"bg-accent-strong text-slate-950 hover:bg-accent-soft disabled:bg-accent-soft/50 disabled:text-slate-900/60",secondary:"bg-surface-muted text-slate-100 hover:bg-surface-subtle disabled:opacity-60 border border-slate-700/60",ghost:"bg-transparent text-slate-300 hover:bg-surface-subtle/50 disabled:opacity-40"},c=(0,r.forwardRef)((e,t)=>{let{className:s,variant:r="primary",type:c="button",...i}=e;return(0,a.jsx)("button",{ref:t,type:c,className:(0,n.cn)("inline-flex items-center justify-center rounded-md text-sm font-semibold transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent-soft focus-visible:ring-offset-2 focus-visible:ring-offset-background",l[r],"px-4 py-2",s),...i})});c.displayName="Button"},5671:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return i},Zb:function(){return n},aY:function(){return d},ll:function(){return c}});var a=s(3827),r=s(2169);function n(e){let{className:t,children:s,...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)("rounded-xl border border-slate-800/80 bg-surface-subtle/80 shadow-card backdrop-blur-sm",t),...n,children:s})}function l(e){let{className:t,children:s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("border-b border-slate-800/40 px-6 py-4",t),children:s})}function c(e){let{className:t,children:s}=e;return(0,a.jsx)("h3",{className:(0,r.cn)("text-lg font-semibold text-slate-100",t),children:s})}function i(e){let{className:t,children:s}=e;return(0,a.jsx)("p",{className:(0,r.cn)("text-sm text-slate-400",t),children:s})}function d(e){let{className:t,children:s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("px-6 py-5",t),children:s})}},2318:function(e,t,s){"use strict";s.d(t,{L:function(){return n},o:function(){return r}});let a=new Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"});function r(e){return a.format(e)}function n(e,t){let s=Math.floor(Math.max(0,t.getTime()-e.getTime())/1e3),a=Math.floor(s/60),r=s%60;return 0===a?"".concat(r,"s"):"".concat(a,"m ").concat(r,"s")}},2169:function(e,t,s){"use strict";s.d(t,{cn:function(){return r}});var a=s(3167);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.W)(t)}},7149:function(e,t,s){"use strict";var a=s(4090);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))});t.Z=r},3167:function(e,t,s){"use strict";function a(){for(var e,t,s=0,a="",r=arguments.length;s<r;s++)(e=arguments[s])&&(t=function e(t){var s,a,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t){if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(a=e(t[s]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a)}return r}(e))&&(a&&(a+=" "),a+=t);return a}s.d(t,{W:function(){return a}})}},function(e){e.O(0,[971,69,744],function(){return e(e.s=812)}),_N_E=e.O()}]);