(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{3406:function(e,t,s){Promise.resolve().then(s.bind(s,7657))},7657:function(e,t,s){"use strict";s.r(t),s.d(t,{ProjectsOverview:function(){return m}});var r=s(3827),n=s(4090),a=s(8792),l=s(7907),c=s(575),i=s(5671),o=s(2782),d=s(2647),u=s(3277),x=s(2111);function m(e){var t,s;let{organizations:m,currentUser:f}=e,b=(0,l.useRouter)(),[p,g]=(0,n.useState)(null!==(s=null===(t=m[0])||void 0===t?void 0:t.id)&&void 0!==s?s:null),[h,j]=(0,n.useState)([]),[v,N]=(0,n.useState)(!1),[w,y]=(0,n.useState)(null),[k,z]=(0,n.useState)({name:"",description:""}),[C,S]=(0,n.useState)(null),O=(0,n.useMemo)(()=>!!f&&("ADMINISTRATOR"===f.role||"OWNER"===f.role),[f]),Z=(0,n.useCallback)(async e=>{N(!0),y(null);try{let s=await fetch("/api/organizations/".concat(e,"/projects"),{cache:"no-store"});if(!s.ok){var t;let e=await s.json().catch(()=>({}));y(null!==(t=e.error)&&void 0!==t?t:"Unable to load projects."),j([]);return}let r=await s.json();j(r)}catch(e){console.warn("Failed to load projects",e),y("Unexpected error loading projects.")}finally{N(!1)}},[]);(0,n.useEffect)(()=>{if(!p){j([]);return}Z(p)},[p,Z]);let Y=(0,n.useMemo)(()=>{var e;return null!==(e=m.find(e=>e.id===p))&&void 0!==e?e:null},[m,p]),I=(0,n.useMemo)(()=>!!Y&&Y.credits>=x.zm,[Y]),_=async e=>{if(e.preventDefault(),p){S(null),y(null);try{let e=await fetch("/api/organizations/".concat(p,"/projects"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:k.name.trim(),description:k.description.trim()||void 0})});if(!e.ok){var t;let s=await e.json().catch(()=>({}));y(null!==(t=s.error)&&void 0!==t?t:"Failed to create project.");return}z({name:"",description:""}),S("Project created successfully."),await Z(p),b.refresh()}catch(e){console.warn("Project creation failed",e),y("Unexpected error creating project.")}}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-slate-200",children:"Organization scope"}),(0,r.jsx)("p",{className:"text-xs text-slate-500",children:"Projects and actions are filtered to the selected organization."})]}),(0,r.jsx)("select",{value:null!=p?p:"",onChange:e=>g(e.target.value||null),className:"w-full rounded-lg border border-slate-800/70 bg-slate-950/70 px-3 py-2 text-sm text-slate-100 sm:w-72",children:m.map(e=>(0,r.jsx)("option",{value:e.id,children:"".concat(e.name," (").concat(e.credits," credits)")},e.id))})]}),Y?(0,r.jsxs)("p",{className:"text-xs text-slate-500",children:["Credits remaining for ",Y.name,": ",Y.credits]}):0===m.length?(0,r.jsx)("p",{className:"text-xs text-warning",children:"No organizations available. Create one before adding projects."}):null,O?(0,r.jsxs)(i.Zb,{className:"border-slate-800/70 bg-slate-950/60",children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsx)(i.ll,{children:"Create project"}),(0,r.jsxs)(i.SZ,{children:["Define a new load-test project within the selected organization. Cost:"," ",x.zm," credits."]})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:_,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(d._,{htmlFor:"project-name",className:"text-xs uppercase tracking-wide text-slate-400",children:"Project name"}),(0,r.jsx)(o.I,{id:"project-name",value:k.name,onChange:e=>z(t=>({...t,name:e.target.value})),placeholder:"Baseline Smoke Tests",className:"mt-2 h-11 rounded-lg border-slate-800/70 bg-slate-950/70 text-slate-100 placeholder:text-slate-600",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d._,{htmlFor:"project-description",className:"text-xs uppercase tracking-wide text-slate-400",children:"Description"}),(0,r.jsx)(o.I,{id:"project-description",value:k.description,onChange:e=>z(t=>({...t,description:e.target.value})),placeholder:"Optional summary for collaborators",className:"mt-2 h-11 rounded-lg border-slate-800/70 bg-slate-950/70 text-slate-100 placeholder:text-slate-600"})]}),(0,r.jsx)("div",{className:"md:col-span-2 flex justify-end",children:(0,r.jsx)(c.z,{type:"submit",className:"h-11 rounded-lg px-5",disabled:!k.name.trim()||v||!Y||!I,children:"Create project"})})]}),Y&&!I?(0,r.jsxs)("p",{className:"mt-3 text-xs text-warning",children:["Insufficient credits. You need ",x.zm," credits to create a project in this organization."]}):null]})]}):(0,r.jsx)(i.Zb,{className:"border-dashed border-slate-800/70 bg-slate-950/50",children:(0,r.jsx)(i.aY,{className:"p-6 text-sm text-slate-400",children:"Only administrators and organization owners can create new projects."})}),C?(0,r.jsx)(i.Zb,{className:"border border-slate-800/60 bg-emerald-500/10",children:(0,r.jsx)(i.aY,{className:"p-4 text-sm text-emerald-300",children:C})}):null,w?(0,r.jsx)(i.Zb,{className:"border border-danger/40 bg-danger/10",children:(0,r.jsx)(i.aY,{className:"p-4 text-sm text-danger",children:w})}):null,v?(0,r.jsx)(i.Zb,{className:"border-slate-800/70 bg-slate-950/60",children:(0,r.jsx)(i.aY,{className:"p-6 text-sm text-slate-400",children:"Loading projects…"})}):0===h.length?(0,r.jsx)(i.Zb,{className:"border-dashed border-slate-800/70 bg-slate-950/50",children:(0,r.jsxs)(i.aY,{className:"p-6 text-sm text-slate-400",children:["No projects found. ",O?"Create your first project above.":"Ask an owner to create one."]})}):(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:h.map(e=>{var t,s;return(0,r.jsxs)(i.Zb,{className:"border-slate-800/70 bg-slate-950/60",children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsx)(i.ll,{className:"text-lg text-slate-100",children:e.name}),e.description?(0,r.jsx)(i.SZ,{children:e.description}):null]}),(0,r.jsxs)(i.aY,{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsx)(u.C,{variant:"default",className:"bg-surface-muted/70 text-slate-300",children:null!==(s=null===(t=m.find(e=>e.id===p))||void 0===t?void 0:t.name)&&void 0!==s?s:"—"}),(0,r.jsx)(a.default,{href:"/tasks?projectId=".concat(e.id,"&organizationId=").concat(null!=p?p:""),className:"inline-flex items-center justify-center rounded-lg border border-slate-800/70 bg-slate-900/70 px-4 py-2 text-sm font-semibold text-slate-100 hover:bg-slate-900",children:"Manage tasks"})]})]},e.id)})})]})}},3277:function(e,t,s){"use strict";s.d(t,{C:function(){return l}});var r=s(3827),n=s(2169);let a={default:"bg-surface-muted text-slate-200",success:"bg-success/20 text-success border border-success/40",warning:"bg-warning/20 text-warning border border-warning/40",danger:"bg-danger/20 text-danger border border-danger/40"};function l(e){let{className:t,variant:s="default",...l}=e;return(0,r.jsx)("span",{className:(0,n.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium uppercase tracking-wide",a[s],t),...l})}},575:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var r=s(3827),n=s(4090),a=s(2169);let l={primary:"bg-accent-strong text-slate-950 hover:bg-accent-soft disabled:bg-accent-soft/50 disabled:text-slate-900/60",secondary:"bg-surface-muted text-slate-100 hover:bg-surface-subtle disabled:opacity-60 border border-slate-700/60",ghost:"bg-transparent text-slate-300 hover:bg-surface-subtle/50 disabled:opacity-40"},c=(0,n.forwardRef)((e,t)=>{let{className:s,variant:n="primary",type:c="button",...i}=e;return(0,r.jsx)("button",{ref:t,type:c,className:(0,a.cn)("inline-flex items-center justify-center rounded-md text-sm font-semibold transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent-soft focus-visible:ring-offset-2 focus-visible:ring-offset-background",l[n],"px-4 py-2",s),...i})});c.displayName="Button"},5671:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return i},Zb:function(){return a},aY:function(){return o},ll:function(){return c}});var r=s(3827),n=s(2169);function a(e){let{className:t,children:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("rounded-xl border border-slate-800/80 bg-surface-subtle/80 shadow-card backdrop-blur-sm",t),...a,children:s})}function l(e){let{className:t,children:s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("border-b border-slate-800/40 px-6 py-4",t),children:s})}function c(e){let{className:t,children:s}=e;return(0,r.jsx)("h3",{className:(0,n.cn)("text-lg font-semibold text-slate-100",t),children:s})}function i(e){let{className:t,children:s}=e;return(0,r.jsx)("p",{className:(0,n.cn)("text-sm text-slate-400",t),children:s})}function o(e){let{className:t,children:s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("px-6 py-5",t),children:s})}},2782:function(e,t,s){"use strict";s.d(t,{I:function(){return l}});var r=s(3827),n=s(4090),a=s(2169);let l=(0,n.forwardRef)((e,t)=>{let{className:s,type:n="text",...l}=e;return(0,r.jsx)("input",{ref:t,type:n,className:(0,a.cn)("w-full rounded-md border border-slate-800 bg-background-subtle px-3 py-2 text-sm text-slate-100 shadow-sm transition focus:border-accent-soft focus:ring-2 focus:ring-accent-soft/60",s),...l})});l.displayName="Input"},2647:function(e,t,s){"use strict";s.d(t,{_:function(){return a}});var r=s(3827),n=s(2169);function a(e){let{className:t,...s}=e;return(0,r.jsx)("label",{className:(0,n.cn)("block text-sm font-medium text-slate-300 tracking-wide",t),...s})}},2111:function(e,t,s){"use strict";s.d(t,{YK:function(){return a},a:function(){return n},kb:function(){return l},zm:function(){return r}});let r=15,n=5,a=5,l=2},2169:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(3167);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.W)(t)}}},function(e){e.O(0,[958,971,69,744],function(){return e(e.s=3406)}),_N_E=e.O()}]);